<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Teste Power Automate</title>
</head>
<body>
<h2>Teste de Poltronas Ocupadas</h2>
<p id="resultado">Carregando...</p>

<script>
async function testarPA() {
    const turma = "AAL"; // Substitua pela turma que deseja testar
    const urlPOST = "https://default264c851fa4e743cf86bcd7b10dca85.78.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/fc2a8382f65e4d6babd3b474ff922f31/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=ECbWzq2eELLbMlCdX8gJq1SygtSQ7s2IqKzdKlMBZo4";

    try {
        const res = await fetch(urlPOST, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ turma })
        });

        const data = await res.json();

        document.getElementById("resultado").textContent = JSON.stringify(data, null, 2);

        // Exibir cada poltrona ocupada separadamente
        if (Array.isArray(data) && data.length > 0) {
            const list = document.createElement("ul");
            data.forEach(item => {
                const li = document.createElement("li");
                li.textContent = "Poltrona ocupada: " + item.ID;
                list.appendChild(li);
            });
            document.body.appendChild(list);
        } else {
            document.body.appendChild(document.createTextNode("Nenhuma poltrona ocupada retornada."));
        }

    } catch (e) {
        document.getElementById("resultado").textContent = "Erro ao comunicar com o Power Automate.";
        console.error(e);
    }
}

testarPA();
</script>
</body>
</html>
